# Building AOI from source

## Quickstart for the experienced developer:

 * Run `millw launch` to build and launch the main application. You can
pass additional arguments to the JVM, such as `-Xmx=` values and debug
transport linkages.
 * `mill _.test` to run the test suites
 * `mill clean` to clear interim build artifacts and force a complete
build on the next run.
 * There is a very thin ant wrapper in `build.xml`. The targets there
are intended to ease integration with IDEs, particularly Intellij Idea
and NetBeans.

If you're new to building java programs, please follow the detailed
process and explanation below:

## Prerequisites

Here's a list of the tools that you will need to work on the AOI
source code:

 * A Java Developer Kit, java 8 or higher. This is a compiler that
turns the java text files into something that the Java runtime can
understand. You can download this from 
[the AdoptOpenJDK project.](https://adoptopenjdk.net) 
    - A Linux user should probably use their package mamager
    - macos users who use Homebrew can use `brew install --cask adoptopenjdk`
 * [Git](https://git-scm.com/downloads) is used for tracking changes
that you have made to the code, and coordinating with other people.
 * An editor suitable for use with program source code. This means
__something other than notepad or Microsoft Word.__ One good, free
option for Windows users is [notepad++.](https://notepad-plus-plus.org)
 * ArtOfIllusion uses the
[mill build tool](https://com-lihaoyi.github.io/mill/mill/Intro_to_Mill.html)
to automate the build process and run tests.
The source archives include wrapper scripts, so you do *not* need to
install this yourself. Simply replace `mill` with `millw` on linux or
`millw.bat` on windows throughout these instructions.

## Obtaining and building the sources

Create a new directory on your hard drive where you would like to
keep your AOI development build, then access it from a command line:

 * If you have a github account, with an SSH key, type:
`git clone git@github.com:ArtOfIllusion/AtrOfIllusion.git`
 * If you don't have an account, or don't use SSH, type:
`git clone https://github.com/ArtOfIllusion/ArtOfIllusion.git`

This will access the repository on github and make a copy in your
directory. This may take a few minutes.

To build AOI, type: `ant`. This will create a working AOI application
in the subdirectory `Live_Application`. This application is suitable
for testing and experimentation, but will not have desktop integration
and filetype association.

To launch AOI, Double-click the `ArtOfIllusion.jar` file in your
installation directory. You may also
launch from the command line with `java -jar ArtOfIllusion.jar`.
Launching from the command line will allow you to see any console output
which AOI generates. You can also add command line options to allow AOI
to use more memory, etc.

### Installing Plugins

You can install plugins normally through the SPManager. The `LocalInstall/`
location is not affected by `mill clean`, so you do not need to reinstall
plugins when you re-build AOI.


### Structure of a development build

If you've followed the above instructions, your `LocalInstall` directory
will contain the following directories and files:

 * __Plugins__ directory where AOI looks for installed
plugins. These include the standard modeling tools and file
translators. The standard plugins are overwritten when
you rebuild. Any other plugins in this directory are not touched, and
can continue to be used from build to build.
 * __Scripts__ directory where beanshell and groovy
scripts live. None are generated by the build process.
 * __Textures and Materials__ Installation directory that holds a library
of .aoi files that contain re-usable textures and materials. The build
process does *not* populate this directory.
 * __ArtOfIllusion.jar__ the compiled main application


### Building installers
AOI installers for Linux and Windows are built using IZPack. The
templates are found in `InstallerSrc` Apple OS mountable .dmg files
are built by hand.

Building any of these yourself should not be neccessary, and is not
recommended.
