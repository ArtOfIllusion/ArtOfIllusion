plugins {
    id 'java'
    id 'application'
    id "com.palantir.git-version" version "0.12.2"
}

description = 'ArtOfIllusion'

mainClassName = 'artofillusion.ArtOfIllusion'

jar {
    manifest {
        attributes('Main-Class': 'artofillusion.ArtOfIllusion', "Implementation-Version": gitVersion())
    }
}

task createAssetsFolder() {
        ext {
            buildDir = layout.buildDirectory.dir('assets')
        }
        doFirst {
            File.createTempDir().with {
                def dir = new File(buildDir.get().asFile, 'Textures And Materials')
                dir.mkdirs()
            }
        }
        outputs.dir(buildDir)
}

tasks.assembleDist.configure {
  dependsOn('createAssetsFolder')
}

distributions {
    main { contents { 
            from("../Plugins") { into("Plugins") }
            from("../Scripts") { into("Scripts") }
            from tasks.createAssetsFolder {
                    includeEmptyDirs = true
            } 
            from("../Textures And Materials") { into("Textures And Materials") }
        } 
    }
}

tasks.distTar.enabled = false


